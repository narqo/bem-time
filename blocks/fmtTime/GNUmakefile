MODULE_NAME := fmtTime
MODULE_SRCFILE := $(MODULE_NAME).src.js

injectHeader = @echo "/* This file was AUTOGENERATED! See $(MODULE_SRCFILE) for source */" > $(1)
injectModuleSrc = @cat $(MODULE_SRCFILE) >> $(1)

all: $(MODULE_NAME).js $(MODULE_NAME).bh.js $(MODULE_NAME).bemhtml 

$(MODULE_NAME).js: $(MODULE_SRCFILE)
	$(call injectHeader,$(@))
	@echo "modules.define('$(MODULE_NAME)', function(provide) {\nvar $(MODULE_NAME) =" >> $(@)
	$(call injectModuleSrc,$(@))
	@echo "provide($(MODULE_NAME));\n});" >> $(@)

$(MODULE_NAME).bh.js: $(MODULE_SRCFILE)
	$(call injectHeader,$(@))
	@echo "module.exports = function(bh) {\nvar $(MODULE_NAME) =" >> $(@)
	$(call injectModuleSrc,$(@))
	@echo ";\nbh.lib['$(MODULE_NAME)'] = $(MODULE_NAME);\n};" >> $(@)

$(MODULE_NAME).bemhtml: $(MODULE_SRCFILE)
	$(call injectHeader,$(@))
	@echo "oninit(function(exports, context) {\nvar $(MODULE_NAME) =" >> $(@)
	$(call injectModuleSrc,$(@))
	@echo ";\ncontext.BEMContext.prototype['$(MODULE_NAME)'] = $(MODULE_NAME);\n});" >> $(@)
